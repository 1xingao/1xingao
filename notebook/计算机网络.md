# 计算机网络

## 第一章计算机网络概述

> ==计算机网络==是一个分散的具有独立得计算机系统，通过通信设备的线路连接起来，由功能完善的软件实现==资源共享==和==信息传递==的系统

> 计算机网络是互联的、自治的计算机集和

### 计算机网络功能

1. ==数据通信==（==连通性==）
2. ==资源共享==（硬件资源 / 软件资源 / 数据）
3. 分布式处理（hadoop）
4. 提高可靠性
5. 负载均衡


### 计算机网络的组成

1. 组成部分（硬件 / 软件 / 协议）
2. 工作方式（边缘部分 （==用户直接使用==）/ 核心部分（==为边缘部分服务==））
3. 功能组成
   - 通信子网 / 实现数据通信
   - 资源子网 / 实现资源共享 or 数据处理
     

### 计算机网络的分类

1. ==按照分布范围分== ： 广域网（wan）、城域网 MAN、 局域网LAN、个人区域网PAN
2. 按照使用者 ： 公用网 、专用网
3. ==按照交换技术分==： 电报交换、报文交换、分组交换
4. ==按照拓扑结构分==：总线型、星型、环形、==网状型==
5. 按照传输技术分 ：广播式 、 点对点
6. 传输技术 ：有线网，无线网


### 三种交换方式

![](https://fastly.jsdelivr.net/gh/1xingao/picgo@main/img/16689361729821668936172128.png)

### 计算机网络的性能指标

> 1Byte = 8bit     

1. 速率：即数据率或者称为数据传输速率，计算机网络上的主机在数字信道上传送比特的速率（b/s,kb/s,Mb/s,Gb/s,Tb/s）
2. 带宽：某个信号具有频带宽度（最高与最低频率之差单位式Hz） / 计算机网络中表示网络通信线路==发送==数据的能力，指的是==最高数据率==单位是==比特每秒==
3. 吞吐量：单位时间内通过某个网络的==数据量==，吞吐量受到网络的带宽或者网络的额定速率的限制
4. 时延 ： ==从网络的一端到另一端所需要的时==间单位s
   - 发送时延 ： 从发送分组的第一个比特算起，到最后一个比特发送完毕的时间 = 分组数据长度/ 信道带宽（发送速率）
   - 传播时延：在信道上传播的时间=信道长度/传播速度，==取决于电磁波传播速度(2e8m/s)和链路长度==
   - 排队时延：等待输出链路可用的等待时间，进入路由和走出路由都有排队时延
   - 处理时延：路由处理信息的时间
5. 时延带宽积 ：(以比特为单位的链路长度)， 传播时延 * 带宽
6. 往返时延：（RTT）==从发送方发送数据开始，到发送方受到接收方确认==的时间
   - RTT越大，在收到确认之前，可以发送的数据越多
   - RTT包括 两倍传输时延 / 末端处理时间
7. 利用率 ： 
   - ==信道利用率== （链路利用率）=有数据通过的时间/总时间
   - 网络利用率 =信道利用率加权平均值
8. 丢包率：
   - 丢包率即分组丢失率，是指在一定的时间范围内，传输过程中丢失的分组数量与总分组数量的比率。
   - 丢包率具体可分为接口丢包率、结点丢包率、链路丢包率、路径丢包率、网络丢包率等。
   - 丢包率是网络运维人员非常关心的一一个网络性能指标，但对于普通用户来说往往并不关心这个指标，

![](C:\Users\藏起来的十七\AppData\Roaming\Typora\typora-user-images\image-20221120180944900.png)



### 分层结构

发送文件前要完成的工作

1. 发起通信计算机必须将数据通信的通路进行激活
2. 告知网络如何识别目标主机
3. 发起通信的计算机要查明目的主机是否开机，并且与网路连接正常
4. 确认对方计算机中文件管理程序是否已经做好准备工作
5. 确保差错和以为可以解决

> 只有对等实体才能由协议 

分层基本原则

1. 各层之间要相互独立，每层只实现一种相对独立的功能
2. 每层之间界面自然清晰
3. 结构上可以分割，每层用最合适的技术来实现
4. 保持下层对上层的独立性，上层单向使用下层的服务

> SDU服务数据单元:为完成用户所要求的功能而应传送的数据。
> PCI协议控制信息:控制协议操作的信息。
> PDU协议数据单元:对等层次之间传送的数据单位。

![](https://fastly.jsdelivr.net/gh/1xingao/picgo@main/img/16687790059991668779005182.png)



### 计算机网络体系结构

![](https://fastly.jsdelivr.net/gh/1xingao/picgo@main/img/16689417029801668941702596.png)



![](https://fastly.jsdelivr.net/gh/1xingao/picgo@main/img/16689416029821668941602046.png)

1. ==应用层==解决通过应用进程的交互来实现特定网络应用的问题(生成/解析http报文)
2. ==表示层==解决通信双方交换信息的表示问题
3. ==会话层==解决用户间的会话问题
4. ==运输层==解决进程之间基于网络的通信问题(为http报文添加tcp报文)
5. ==网络层==解决分组在多个网络上传输(路由)的问题(添加ip)
6. ==数据链路层==解决分组在一个网络(或-段链路)，上传输的问题(封装报文为帧，添加首部和尾部)
7. ==物理层==解决使用何种信号来传输比特的问题(将数据转化为信号传输)

==对等层次之间传送的数据包称为协议数据单元（PDU）==

==同一i系统内，层与层之间传输的数据包称为服务数据单元（SDU）==

<img src="https://fastly.jsdelivr.net/gh/1xingao/picgo@main/img/16690184473311669018446917.png" style="zoom:50%;" />

![](https://fastly.jsdelivr.net/gh/1xingao/picgo@main/img/16690837789121669083778815.png)

## 第二章物理层

> 物理层考虑的是怎样才能在连接各种计算机的传输媒体上==传输数据比特流==。
> 物理层为数据链路层屏蔽了各种传输媒体的差异，==使数据链路层只需要考虑如何完成本层的协议和服务==，而不必考虑网络具体的传输媒体是什么。

### 物理层协议的主要任务

1. 机械特性：指明接口所用接线器的形状和尺寸、特性、引脚数目和排列、固定和锁定装置。
2. 电气特性：指明在接口电缆的各条线上出现的电压的范围。
3. 功能特性：知名某条线上出现的某一电平的电压表示何种意义
4. 过程特性：指明对于不同功能的各种可能的时间的出现顺序

### 物理层下面的传输媒体

1. 导引型传输媒体：同轴电缆、双绞线、光纤、电力线
2. 非导引型传输媒体：无线电波、微波、红外线、可见光

> 绞合的作用：地狱外界带你系干扰、减少相信导线的电磁干扰

### 传输方式

1. ==串行传输==：数据是一个bit单次发送
2. 并行传输：同时传输多个bit发送
3. ==同步传输==：收发双方时钟同步
4. ==异步传输==：以字节为单位进行传输，字节之间的间隔不固定
5. 单工通信：单向通信
6. 半双工通信：双发不能同时通信
7. 全双工通信：可以同时通信

![](https://fastly.jsdelivr.net/gh/1xingao/picgo@main/img/16691040265461669104026036.png)

### 编码与调制

==编码==：在不改变信号性质的前提下，仅仅对数字基带信号的波形进行变换（数字信号->数字信号）

==调制==：将数字信号搬移到较高的范围转化为模拟信号称为调制（数字信号->模拟信号）

==码元==：数字的基本波形

==常用编码==

1. 不归零编码（需要一根额外的传输线传输时钟信号用以判断1的个数）（NRZ）
2. 归零编码（自同步信号）（编码效率低）（RZ）
3. 曼彻斯特编码
4. 差分曼彻斯特编码

![](https://fastly.jsdelivr.net/gh/1xingao/picgo@main/img/16691046225401669104622408.png)

==调制方法==

1. 调幅
2. 调频
3. 调相
4. 混合调制

![](https://fastly.jsdelivr.net/gh/1xingao/picgo@main/img/16691052125411669105212505.png)

### 信道极限容量

==产生失真的原因==

1. 码元传输速率
2. 信号传输距离
3. 噪声干扰
4. 传输媒体质量

==奈氏准则==：在假定的理想条件下，为了避免码间串扰，码元传输速率是有上限的W为带宽（Hz）

![](https://fastly.jsdelivr.net/gh/1xingao/picgo@main/img/16691058835461669105882926.png)



在信道带宽一定的情况下，根据奈氏准则和香农公式，要想提高信息的传输速率就必须采用多元制(更好的调制方法)和努力提高信道中的信噪比。

![](https://fastly.jsdelivr.net/gh/1xingao/picgo@main/img/16691057855451669105784897.png)

==数据传输速率===波特率（码元传输速率）* 每个码元携带的信息量

码元传输速率又称为波特率 / 调制速率/ 波形速率 / 符号速率

## 第三章数据链路层

> 链路：从一个结点到相邻节点的物理链路，而中间没有任何交换节点
>
> 数据链路：是把实现通信协议的硬件和软件加到链路上，构成数据链路
>
> 数据链路层以帧为单位传输和处理数据

使用点对点通信信道==数据链路层==的三个问题

1. 封装成帧
2. 差错检测
3. 可靠传输

使用广播通信信道的数据链路层

1. 共享式以太网的媒体接入控制协议CSMA/CD
2. 802.11局域网的媒体介入控制协议CDMA/CA

数据链路层的互联设备

1. 网桥和交换机的工作原理
2. 集线器与交换机的区别

### 封装成帧

> 封装成这指的是给上册交付的协议数据单元添加帧头和帧尾使之成为帧

1. 帧头和帧尾包含有重要的控制信息
2. 帧头帧尾的作用之一就是帧定界

==透明传输==：指的是数据链路层对上层交付的数据没有任何限制，交付的内容可以含有帧尾定界符

解决方法：

1. 在数据出现帧尾数据的时候在前面插入转义符
2. 面向字节的物理链路使用字节填充(或称字符填充)的方法实现透明传输。
3. 面向比特的物理链路使用比特填充的方法实现透明传输。

### 差错检测

> 实际的通信链路都不是理想的，比特在传输过程中可能会产生差错: 1可能会变成0
> 而0也可能变成1。这称为==比特差错==。

 在一段时间内，传输错误的比特占所传输比特总数的比率称为==误码率==BER(Bit Error Rate)。

> 使用差错检测码来检测数据在传输过程中是否产生了比特差错，是数据链路层所要解决的
> 重要问题之一。

#### ==奇偶校验==

1. 在待发送的数据后面添加1位奇偶校验位，使整个数据(包括所添加的校验位在内)中“1”的个数
2. 为奇数(奇校验)或偶数(偶校验)。
3. 如果有奇数个位发生误码，则奇偶性发生变化，可以检查出误码;
4. 如果有偶数个位发生误码，则奇偶性不发生变化，不能检查出误码(漏检) ;

#### ==循环冗余校验==

![](https://fastly.jsdelivr.net/gh/1xingao/picgo@main/img/16692095212011669209520628.png)

==检错码只能检测出帧在传输过程中出现了差错==，但并不能定位错误，因此无法纠正错误。

要想纠正传输中的差错，可以==使用冗余信息更多的纠错码进行前向纠错==。但纠错码的开销比较大，在计算机网络中==较少使用==。

循环冗余校验CRC有很好的检错能力(漏检率非常低)，虽然计算比较复杂，但非常易于用硬件实现，因此被广泛应用于数据链路层。

在计算机网络中通常采用我们后续课程中将要讨论的==检错重传方式==来纠正传输中的差错,或者仅仅是丢弃检测到差错的帧，这取决于数据链路层向其上层提供的是可靠传输服务还是不可靠传输服务。

### 可靠性传输基本概念

#### 数据链路层向上层提供的服务类型

==不可靠传输服务==:仅仅丢弃有误码的帧，其他什么也不做;

==可靠传输服务==:想办法实现发送端发送什么，接收端就收到什么。

一般情况下，有线链路的误码率比较低，为了减小开销，并不要求数据链路层向.上提供可靠传输服务。即使出现了误码，可靠传输的问题由其上层处理。

传输差错包括

1. 比特差错
2. 分组丢失
3. 分组失序
4. 分组重复

==除了比特差错一般不会出现在数据链路层==

可靠传输服务并不仅局限于数据链路层，其他各层均可选择实现可靠传输。

可靠传输的实现比较复杂，开销也比较大,是否使用可靠传输取决于应用需求。

### ==可靠传输机制==

#### 停止-等待协议SW（自动请求重传协议）

1. 发送方发送数据分组
2. 等待接收方的==确认分组ACK==或者==否认分组NAK==
3. 重发或者继续发送

![](https://fastly.jsdelivr.net/gh/1xingao/picgo@main/img/16692731406501669273140078.png)

==注意事项==

1. 接收端检测到数据分组有误码时，将其丢弃并等待发送方的超时重传。但对于误码率较高的点对点链路，为使发送方==尽早重传==，也可==给发送方发送NAK分组==。
2. 为了让接收方能够判断所收到的数据分组是否是重复的,需要给==数据分组编号==。由于停止等待协议的停等特性，==只需1个比特编号就够了==，即编号0和1.
3. 为了让发送方能够判断所收到的ACK分组是否是重复的，需要==给ACK分组编号==,所用比特数量与数据分组编号所用比特数量-样。 数据链路层一般不会出现ACK分组迟到的情况，因此在数据链路层实现停止-等待协议可以不用给ACK分组编号。
4. 超时计时器设置的重传时间应仔细选择。一般可将重传时间选为略大于==“从发送方到接收方的平均往返时间”==
   - 在数据链路层点对点的往返时间比较确定，重传时间比较好设定。
   - 然而在运输层，由于端到端往返时间非常不确定，设置合适的重传时间有时并不容易。

==信道利用率==

$U（信道利用率） =  \frac{T_d} { T_d+RTT + T_a}$

> $T_d$是数据的发送时延，$RTT$为往返传输时延，$T_A$为确认分组的发送时延

#### 回退N帧协议GBN

1. 采用==n==个bit给分组编号
2. 发送窗口的尺寸$W_T$ 的取值范围为$1 < W_T <= 2^n-1$
3. 接受窗口的尺寸$W_R$取值为1（按照顺序接收）
4. 发送方一次将$W_t$个数据发送
5. 接收方逐个接收返回ACK
6. 接收方每接收一个就向前滑动窗口
7. 接收方每接收一个ACK也向前滑动一个窗口
8. 若接收方接受的不是当前窗口的值，就会返回上一个==成功接收的data==

> 接收方不一定要对收到的数据分组逐个发送确认，而是可以在收到几个数据分组后(由具体实现决定)
> 对按序到达的最后一一个数据分组发送确认。ACKn表示序号为n及以前的所有数据分组都已正确接收。

![](https://fastly.jsdelivr.net/gh/1xingao/picgo@main/img/16692753356401669275335413.png)

#### 选择重传协议SR

base GBN

不使用累计重传机制

发送窗口按照接收到的ACK需要向前滑动窗口，遇到未接收到的ACK不能向前

$W_r = W_t<=2^{n-1}$

![](https://fastly.jsdelivr.net/gh/1xingao/picgo@main/img/16692763166371669276316412.png)

### 点对点协议PPP

> 最广泛使用的点对点数据链路层协议

ppp协议在点对点链路传输的各种协议数据报提供了一个标准方法，主要包括

1. 对各种控制协议数据报封装方法
2. 链路控制协议LCP，用于建立、配置以及测试数据链路的连接
3. 一套网络控制协议NCPs，其中每一个协议支持不同的网络层协议

![](https://fastly.jsdelivr.net/gh/1xingao/picgo@main/img/16692926356311669292635418.png)

==透明传输的实现==

1. 面向字节的地步链路采用插入转义字符的字节填充法
2. 面向比特的同步链路采用插入比特0的比特填充法

==差错检测实现==

循环冗余校验 

$CRC-CCITT = x^{16}+x^{12}+x^5+1$

==工作状态==

![](https://fastly.jsdelivr.net/gh/1xingao/picgo@main/img/16692931836301669293182804.png)

###  媒体接入控制

